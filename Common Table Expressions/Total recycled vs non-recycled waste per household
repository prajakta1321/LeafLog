# Total recycled vs non-recycled waste per household
WITH WasteSummary AS (
    SELECT 
        household_id,
        SUM(recycled_kg) AS total_recycled,
        SUM(non_recycled_kg) AS total_non_recycled
    FROM WasteManagement
    GROUP BY household_id
)
SELECT 
    household_id,
    total_recycled,
    total_non_recycled,
    (total_recycled / (total_recycled + total_non_recycled)) * 100 AS recycle_percentage
FROM WasteSummary;
